<div class="profile-container">
  <div class="profile-card">
      <h1>Your Profile</h1>

      @if (user) {
        <div class="user-badge">
          <div class="badge-icon">{{ user.nickname.charAt(0).toUpperCase() }}</div>
          <div class="badge-info">
            <h2>{{ user.nickname }}</h2>
            <span class="role-badge" [class.admin]="user.role === 'admin'">
              {{ user.role }}
            </span>
          </div>
        </div>

        <form [formGroup]="profileForm" (ngSubmit)="onSubmit()">
          <!-- Success Message -->
          @if (successMessage) {
            <div class="alert alert-success">
              {{ successMessage }}
            </div>
          }

          <!-- Error Message -->
          @if (errorMessage) {
            <div class="alert alert-error">
              {{ errorMessage }}
            </div>
          }

          <div class="form-section">
            <h3>Account Information</h3>
            
            <!-- Email Field -->
            <div class="form-group">
              <label for="email">Email</label>
              <input
                type="email"
                id="email"
                formControlName="email"
                [class.invalid]="email?.invalid && email?.touched"
              />
              @if (email?.invalid && email?.touched) {
                <div class="error-text">
                  @if (email?.errors?.['required']) {
                    <span>Email is required</span>
                  }
                  @if (email?.errors?.['email']) {
                    <span>Please enter a valid email</span>
                  }
                </div>
              }
            </div>

            <!-- Nickname Field -->
            <div class="form-group">
              <label for="nickname">Nickname</label>
              <input
                type="text"
                id="nickname"
                formControlName="nickname"
                [class.invalid]="nickname?.invalid && nickname?.touched"
              />
              @if (nickname?.invalid && nickname?.touched) {
                <div class="error-text">
                  @if (nickname?.errors?.['required']) {
                    <span>Nickname is required</span>
                  }
                  @if (nickname?.errors?.['minlength']) {
                    <span>Nickname must be at least 3 characters</span>
                  }
                </div>
              }
            </div>
          </div>

          <div class="form-section">
            <h3>Address Information (Optional)</h3>
            
            <!-- Street Address -->
            <div class="form-group">
              <label for="street_address">Street Address</label>
              <input
                type="text"
                id="street_address"
                formControlName="street_address"
                placeholder="123 Main Street"
              />
            </div>

            <!-- City and Postal Code -->
            <div class="form-row">
              <div class="form-group">
                <label for="city">City</label>
                <input
                  type="text"
                  id="city"
                  formControlName="city"
                  placeholder="Berlin"
                />
              </div>

              <div class="form-group">
                <label for="postal_code">Postal Code</label>
                <input
                  type="text"
                  id="postal_code"
                  formControlName="postal_code"
                  placeholder="10115"
                />
              </div>
            </div>

            <!-- Country -->
            <div class="form-group">
              <label for="country">Country</label>
              <input
                type="text"
                id="country"
                formControlName="country"
                placeholder="Germany"
              />
            </div>
          </div>

          <div class="form-section">
            <h3>Payment Information (Optional)</h3>
            
            <!-- Payment Method -->
            <div class="form-group">
              <label for="payment_method">Payment Method</label>
              <input
                type="text"
                id="payment_method"
                formControlName="payment_method"
                placeholder="Credit Card, PayPal, etc."
              />
            </div>
          </div>

          <!-- Submit Button -->
          <button
            type="submit"
            class="btn btn-primary"
            [disabled]="profileForm.invalid || isLoading"
          >
            @if (isLoading) {
              <span>Saving...</span>
            } @else {
              <span>Save Changes</span>
            }
          </button>
        </form>
      }
    </div>
  </div>
