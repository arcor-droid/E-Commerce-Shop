<div class="admin-orders-container">
  <div class="admin-header">
    <h1>Order Management</h1>
    <p class="subtitle">Manage and track all customer orders</p>
  </div>

  <!-- Filter Section -->
  <div class="filter-section">
    <label for="statusFilter">Filter by Status:</label>
    <select id="statusFilter" [(ngModel)]="statusFilter" (change)="onFilterChange()" class="status-filter">
      <option value="">All Orders</option>
      <option *ngFor="let status of ORDER_STATUSES" [value]="status">{{ status }}</option>
    </select>
  </div>

  <!-- Loading State -->
  <div *ngIf="isLoading" class="loading">
    <p>Loading orders...</p>
  </div>

  <!-- Error State -->
  <div *ngIf="error" class="error-message">
    <p>{{ error }}</p>
    <button (click)="loadOrders()" class="btn-retry">Retry</button>
  </div>

  <!-- Orders Table -->
  <div *ngIf="!isLoading && !error" class="orders-section">
    <div *ngIf="filteredOrders.length === 0" class="no-orders">
      <p>No orders found.</p>
    </div>

    <div *ngIf="filteredOrders.length > 0" class="orders-table-container">
      <table class="orders-table">
        <thead>
          <tr>
            <th>Order ID</th>
            <th>Customer</th>
            <th>Date</th>
            <th>Items</th>
            <th>Total</th>
            <th>Status</th>
            <th>Actions</th>
          </tr>
        </thead>
        <tbody>
          <tr *ngFor="let order of filteredOrders">
            <td class="order-id">#{{ order.id }}</td>
            <td class="customer-info">
              <div class="customer-name">{{ order.user_nickname }}</div>
              <div class="customer-email">{{ order.user_email }}</div>
            </td>
            <td class="order-date">{{ formatDate(order.order_date) }}</td>
            <td class="order-items-count">{{ order.order_items.length }} item(s)</td>
            <td class="order-total">{{ formatCurrency(order.total) }}</td>
            <td class="order-status">
              <select 
                [value]="order.status" 
                (change)="onStatusChange(order, $any($event.target).value)"
                [disabled]="updatingOrderId === order.id"
                [class]="getStatusBadgeClass(order.status) + ' status-select'">
                <option *ngFor="let status of ORDER_STATUSES" [value]="status">
                  {{ status }}
                </option>
              </select>
              <span *ngIf="updatingOrderId === order.id" class="updating">Updating...</span>
            </td>
            <td class="order-actions">
              <a [routerLink]="['/admin/orders', order.id]" class="btn-view">View Details</a>
            </td>
          </tr>
        </tbody>
      </table>
    </div>

    <div class="orders-summary">
      <p>Total Orders: {{ filteredOrders.length }}</p>
    </div>
  </div>
</div>
